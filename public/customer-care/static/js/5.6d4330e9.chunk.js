(window["webpackJsonpcustomer-care"]=window["webpackJsonpcustomer-care"]||[]).push([[5],{1792:function(e,t,n){},1806:function(e,t,n){"use strict";n.r(t);var a=n(8),c=n(9),r=n(13),i=n(11),s=n(335),o=n(12),l=n(114),u=n(0),m=n(95),p=n(336),d=n.n(p),f=n(717),h=n(115),b=n(735),k=n(1804),g=n(715),y=n(733),v=n(711),O=n(707),j=n(362),E=n(665),C=n(364),_=n(705),w=n(1793),S=n(45),x=n(16),T=n(737),N=n(6),D=n(1805),L=n(727),P=Object(_.a)({root:{position:"fixed",width:"100%",height:"100%",zIndex:9999,right:"0px",bottom:"0px",top:"0px",left:"0px",textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},container:{height:"100%",outline:0,alignItems:"center",justifyContent:"center",display:"flex",flexDirection:"column"}}),I=function(){var e=P();return u.createElement("div",{className:e.root},u.createElement("div",{className:e.container},u.createElement(L.a,{size:150})))};I.defaultProps={};var A={ResetReducer:"TicketList_ResetReducer",SetReducer:"TicketList_SetReducer"},F=function(e){return{payload:e,type:A.SetReducer}},R=n(745),q=n.n(R),z=[{name:"urgency",title:"Urgency"},{name:"status",title:"Status"},{name:"app_number",title:"Ticket ID"},{name:"dueDate",title:"Due Date"},{name:"type",title:"Type"},{name:"specificType",title:"Specific Type"},{name:"member",title:"Member"},{name:"company",title:"Company"},{name:"ticketOwner",title:"Ticket Owner"},{name:"assignedTo",title:"Assigned To"},{name:"createdDate",title:"Created Date"},{name:"lastUpdate",title:"Last Update"},{name:"channel",title:"Channel"},{name:"is_vip",title:"VIP"}],B={formattedColumns:{required_columns:[],urgency_columns:["urgency"],text_columns:["status","app_uid","type","specificType","member","company","ticketOwner","assignedTo","channel"],date_columns:["dueDate","createdDate","lastUpdate"],boolean_columns:["is_vip"],detaillink_columns:["app_uid"]},columnExtensions:function(){var e=[];return z.map(function(t){var n=200;switch(t.name){case"urgency":case"status":case"app_uid":n=100;break;case"type":case"dueDate":n=120;break;case"specificType":case"company":n=250;break;default:n=200}e.push({columnName:t.name,width:n,wordWrapEnabled:!0})}),e}(),fixedColumns:["urgency","status","dueDate","app_uid","type","specificType","member"],cellProperties:[],columns:z,rows:function(){for(var e=[],t=["Inquiry","Availment","Request","Complaint"],n=["Billing Dispute Inquiry","Outpatient Consult","X-Ray Procedure Availment","Service Complaint","Dental Coverage","Premium Adjustment"],a=["open","pending","resolved","closed"],c=["email","fax","sms"],r=[!0,!1],i=0;i<50;i++){var s=q.a.random.arrayElement(a),o="closed"===s||"resolved"===s?3:q.a.random.arrayElement([1,2]);e.push({urgency:o,status:Object(T.capitalize)(s),app_uid:q.a.random.alphaNumeric(8),dueDate:q.a.date.future(),type:q.a.random.arrayElement(t),specificType:q.a.random.arrayElement(n),member:q.a.name.findName(),company:q.a.company.companyName(),ticketOwner:q.a.name.findName(),assignedTo:q.a.name.findName(),createdDate:q.a.date.future(),lastUpdate:q.a.date.future(),channel:q.a.random.arrayElement(c),is_vip:q.a.random.arrayElement(r)})}return e}()},U=n(56),W=n.n(U),J=n(83),H="http://18.138.94.224:4101/api/",M=function(){function e(){Object(a.a)(this,e)}return Object(c.a)(e,null,[{key:"get",value:function(){var e=Object(J.a)(W.a.mark(function e(t,n,a){return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch(H+t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("pm_token")}}).then(function(e){return e.json()}).then(function(e){return n(e)}).catch(function(e){return a(e)});case 1:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(J.a)(W.a.mark(function e(t,n,a,c){return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch(H+t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("pm_token")},body:JSON.stringify(n)}).then(function(e){return e.json()}).then(function(e){return a(e)}).catch(function(e){return c(e)});case 1:case"end":return e.stop()}},e)}));return function(t,n,a,c){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(J.a)(W.a.mark(function e(t,n,a,c){return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch(H+t,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("pm_token")},body:JSON.stringify(n)}).then(function(e){return e}).then(function(e){return a(e)}).catch(function(e){return c(e)});case 1:case"end":return e.stop()}},e)}));return function(t,n,a,c){return e.apply(this,arguments)}}()}]),e}(),G=function(){function e(){Object(a.a)(this,e)}return Object(c.a)(e,null,[{key:"get",value:function(){var e=Object(J.a)(W.a.mark(function e(t,n,a){var c;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c=localStorage.getItem("pm_token")||"",fetch("http://18.140.39.215/api/1.0/workflow/"+t,{method:"GET",headers:{Authorization:"Bearer "+c}}).then(function(e){return e.json()}).then(function(e){return n(e)}).catch(function(e){return a(e)});case 2:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(J.a)(W.a.mark(function e(t,n,a,c){return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://18.140.39.215/api/1.0/workflow/"+t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("pm_token")},body:JSON.stringify(n)}).then(function(e){return e.json()}).then(function(e){return a(e)}).catch(function(e){return c(e)});case 1:case"end":return e.stop()}},e)}));return function(t,n,a,c){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(J.a)(W.a.mark(function e(t,n,a,c){return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://18.140.39.215/api/1.0/workflow/"+t,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("pm_token")},body:JSON.stringify(n)}).then(function(e){return e}).then(function(e){return a(e)}).catch(function(e){return c(e)});case 1:case"end":return e.stop()}},e)}));return function(t,n,a,c){return e.apply(this,arguments)}}()}]),e}(),V=(n(1792),n(15)),X=n(31),Y=n(24),K=n(18);n.d(t,"TicketListPage",function(){return $}),n.d(t,"mapStateToProps",function(){return ee}),n.d(t,"mapDispatchToProps",function(){return te});var Q=Object(_.a)(function(e){return{popoverCheckbox:{marginLeft:e.spacing(2),marginRight:e.spacing(2)}}}),Z=function(e){var t=e.columns,n=e.selectedColumns,a=e.setSelectedColumns,c=Q(e),r=Object(w.usePopupState)({variant:"popover",popupId:"columnListPopover"});return u.createElement("div",null,u.createElement(f.a,Object.assign({fullWidth:!0},Object(w.bindTrigger)(r)),u.createElement(h.a,{className:Object(N.default)("link-button"),align:"right"},u.createElement(S.a,{icon:x.t,className:Object(N.default)("link-button-icon")}),u.createElement("span",{className:Object(N.default)("link-button-text")},"Display Columns"))),u.createElement(b.a,Object.assign({},Object(w.bindPopover)(r),{anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}}),u.createElement(k.a,null,Object(T.map)(t,function(e,t){var r,i=Object(T.findIndex)(n,{name:e.name})>=0;return u.createElement(g.a,{key:t,control:u.createElement(y.a,{checked:i,onChange:(r=e,function(e){if(e.target.checked){var t=Object(l.a)(n);t.push(r),a(t)}else{var c=Object(l.a)(n);Object(T.remove)(c,function(e){return e.name===r.name}),a(c)}}),value:e.name,color:"primary"}),className:c.popoverCheckbox,label:e.title})}))))},$=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(i.a)(t).call(this,e))).tickets=void 0,n.onLogout=function(){window.location.replace("../index.html#/")},n.reset=function(){n.setState({loading:!1,query:""})},n.getTicketStats=function(e){var t,n=0,a=0,c=0,r=0;t=e.length;var i=!0,s=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var m=l.value;switch(Object(T.lowerCase)(m.status)){case"open":n++;break;case"pending":r++;break;case"resolved":c++;break;case"closed":a++}}}catch(p){s=!0,o=p}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}return{all:t,open:n,closed:a,resolved:c,pending:r}},n.filterTickets=function(){var e=Object(s.a)(n),t=e.state.ticketList?e.state.ticketList:[],a=e.state.query?e.state.query.trim().toLowerCase():"";e.setState({loading:!0},function(){var n=t.filter(function(e){var t=e.status.toLowerCase(),n=e.app_number.toLowerCase();return t.includes(a)||n.includes(a)});e.setState({loading:!1,rows:n})})},n.loadTicketList=function(){n.state.loading||n.setState({loading:!0},function(){G.get("cases/participated",function(e){var t=e.map(function(e){var t=e.app_uid,n=e.del_index,a=e.app_number;return new Promise(function(e){G.get("cases/"+t+"/variables?app_index="+n,function(t){e({app_uid:t.APPLICATION,ticket_no:t.ticket_no||null,app_number:a})},function(t){console.log("error",t),e(null)})})});Promise.all(t).then(function(e){M.get("customer-care/tickets",function(t){var a={};t.forEach(function(e){var t={urgency:e.ticket_category.urgency,status:e.status,ticket_no:e._id,dueDate:null,type:e.ticket_category.ticket_type,specificType:e.ticket_category.specific_type,member:e.caller_name,company:e.corporate_client,ticketOwner:"",assignedTo:e.ticket_category.assign_to,createdDate:new Date(e.date_created),lastUpdate:new Date(e.date_updated),channel:e.received_via,is_vip:!1,transaction_no:e.transaction_no,app_uid:"",app_number:""};a[e._id]=t}),console.log(e);var c=e.map(function(e){if(null!==e.app_uid&&null!==e.ticket_no){var t=a[e.ticket_no]||null;return null!=t?(t.app_uid=e.app_uid,t.app_number=V.a.generateTicketNumber(t.type,t.specificType,e.app_number),t):null}return null}).filter(function(e){return null!==e}),r=n.getTicketStats(c);n.setState({loading:!1,ticketList:c,rows:c,ticketStats:r})},function(e){console.log("error",e)})})},function(e){console.log("error",e);var t=[{urgency:"High",status:"Pending",ticket_no:"123",dueDate:new Date,type:"Availment",specificType:"Outpatient",member:"Juan",company:"Square Enix",ticketOwner:"Juan",assignedTo:"Me",createdDate:new Date,lastUpdate:new Date,channel:"Call",is_vip:!0,transaction_no:"transaction_no",app_uid:"app_uid",app_number:"app_number"}],a=n.getTicketStats(t);n.setState({loading:!1,ticketList:t,rows:t,ticketStats:a})})})},n.setSelectedColumns=function(e){n.setState({selectedColumns:e})},n.getVisibleColumns=function(){return Object(T.filter)(n.state.columns,function(e){return Object(T.findIndex)(n.state.selectedColumns,{name:e.name})>=0})},n.generateReport=function(){console.log("generate report")},n.onSearchTextChange=function(e){e.preventDefault();var t=e.target.value;n.setState({query:t},function(){return n.filterTickets()})},n.onStatusFilterClick=function(e){n.state.status!==e&&n.setState({status:e},function(){return n.filterTickets()})},n.componentWillMount=function(){var e=B.columns;n.setState({columns:e,selectedColumns:e,fixedColumns:Object.keys(B).length>0?B.fixedColumns:[],formattedColumns:Object.keys(B).length>0?B.formattedColumns:[],columnExtensions:Object.keys(B).length>0?B.columnExtensions:[]})},n.componentDidMount=function(){n.loadTicketList()},n.getFilteredTickets=function(e){var t=n.tickets;return console.log(t),e.map(function(e){console.log(e),t=t.filter(function(t){return!n.state.filters[e.name]||(""===n.state.filters[e.name]||t[e.name].toString().toLowerCase().includes(n.state.filters[e.name].toLowerCase()))})}),t},n.state={loading:!1,status:"",query:"",columns:[],selectedColumns:[],fixedColumns:[],formattedColumns:{},columnExtensions:[],rows:[],ticketStats:{},ticketList:[],filters:{}},n.tickets=[],n}return Object(o.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return u.createElement("div",null,this.state.loading?u.createElement(I,null):null,u.createElement("div",{style:{position:"absolute",right:"1rem",top:"1rem"}},u.createElement(D.a,{color:"primary",style:{backgroundColor:"#CCCCCC"}},u.createElement(d.a,{onClick:this.onLogout}))),u.createElement("div",{className:Object(N.default)("TicketListPage")},u.createElement(v.a,{container:!0,direction:"row",justify:"space-between",alignItems:"baseline"},u.createElement(v.a,{item:!0,xs:12,className:Object(N.default)("header-label")},u.createElement(h.a,{className:Object(N.default)("title"),color:"textPrimary"},"Tickets"))),u.createElement(v.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",spacing:1,className:Object(N.default)("search")},u.createElement(v.a,{item:!0,sm:12,md:8},u.createElement(O.a,{id:"cc_search_tickets_tf",placeholder:"Search ticket ID, approval code, subject, or recipient",className:Object(N.default)("search-field"),margin:"dense",variant:"outlined",fullWidth:!0,onChange:this.onSearchTextChange,value:this.state.query,inputProps:{"aria-label":"bare"},InputProps:{startAdornment:u.createElement(S.a,{icon:x.p,className:Object(N.default)("input-adornment")})}})),u.createElement(v.a,{item:!0,sm:6,md:2,alignContent:"flex-end",justify:"flex-end"},u.createElement(f.a,{fullWidth:!0,onClick:function(){e.generateReport()}},u.createElement(h.a,{className:Object(N.default)("link-button"),align:"right"},u.createElement(S.a,{icon:x.e,className:Object(N.default)("link-button-icon")}),u.createElement("span",{className:Object(N.default)("link-button-text")},"Generate Report")))),u.createElement(v.a,{item:!0,sm:6,md:2,alignContent:"flex-end"},u.createElement(Z,{setSelectedColumns:this.setSelectedColumns,columns:this.state.columns,selectedColumns:this.state.selectedColumns}))),u.createElement(v.a,{container:!0,direction:"row",className:Object(N.default)("tickets-table")},u.createElement(v.a,{item:!0,xs:12},u.createElement(j.a,{className:Object(N.default)("tickets-table-container")},u.createElement(v.a,{container:!0,xs:12},u.createElement(v.a,{item:!0,xs:!0,className:Object(N.default)("tickets-table-stats")},u.createElement(h.a,{align:"center",onClick:function(){e.onStatusFilterClick("")}},u.createElement("span",{className:""==this.state.status?Object(N.default)("tickets-all"):Object(N.default)("tickets-default")},this.state.ticketStats.all?this.state.ticketStats.all:0),u.createElement("span",{className:""==this.state.status?Object(N.default)("ticket-label-active"):Object(N.default)("ticket-label")},"ALL"))),u.createElement(v.a,{item:!0,xs:!0,className:Object(N.default)("tickets-table-stats")},u.createElement(h.a,{align:"center",onClick:function(){e.onStatusFilterClick("open")}},u.createElement("span",{className:"open"==this.state.status?Object(N.default)("tickets-open"):Object(N.default)("tickets-default")},this.state.ticketStats.open?this.state.ticketStats.open:0),u.createElement("span",{className:"open"==this.state.status?Object(N.default)("ticket-label-active"):Object(N.default)("ticket-label")},"OPEN"))),u.createElement(v.a,{item:!0,xs:!0,className:Object(N.default)("tickets-table-stats")},u.createElement(h.a,{align:"center",onClick:function(){e.onStatusFilterClick("pending")}},u.createElement("span",{className:"pending"==this.state.status?Object(N.default)("tickets-pending"):Object(N.default)("tickets-default")},this.state.ticketStats.pending?this.state.ticketStats.pending:0),u.createElement("span",{className:"pending"==this.state.status?Object(N.default)("ticket-label-active"):Object(N.default)("ticket-label")},"PENDING"))),u.createElement(v.a,{item:!0,xs:!0,className:Object(N.default)("tickets-table-stats")},u.createElement(h.a,{align:"center",onClick:function(){e.onStatusFilterClick("resolved")}},u.createElement("span",{className:"resolved"==this.state.status?Object(N.default)("tickets-resolved"):Object(N.default)("tickets-default")},this.state.ticketStats.resolved?this.state.ticketStats.resolved:0),u.createElement("span",{className:"resolved"==this.state.status?Object(N.default)("ticket-label-active"):Object(N.default)("ticket-label")},"RESOLVED"))),u.createElement(v.a,{item:!0,xs:!0,className:Object(N.default)("tickets-table-stats")},u.createElement(h.a,{align:"center",onClick:function(){e.onStatusFilterClick("closed")}},u.createElement("span",{className:"closed"==this.state.status?Object(N.default)("tickets-closed"):Object(N.default)("tickets-default")},this.state.ticketStats.closed?this.state.ticketStats.closed:0),u.createElement("span",{className:"closed"==this.state.status?Object(N.default)("ticket-label-active"):Object(N.default)("ticket-label")},"CLOSED")))),u.createElement(v.a,{item:!0,xs:12,style:{overflow:"auto"}},u.createElement(X.a,{className:"ticket-list-table",canOverflow:!0,rows:this.state.rows,stickyHeader:!0,renderHeader:function(){return e.renderTableHeader(e.state.columns,e.state.fixedColumns)},renderRow:function(t,n){return e.renderTableRow(t,n,e.state.columns,e.state.fixedColumns)},rowsPerPageOptions:[5,10,15]})))))))}},{key:"renderTableHeader",value:function(e,t){var n=this,a=0;return u.createElement(u.Fragment,null,e.map(function(c,r){var i=t.filter(function(e){return e===c.name})[0],s=!0;i&&e[r+1]&&(s=!!t.filter(function(t){return t===e[r+1].name})[0]);var o={left:i?125*a:0,zIndex:i?125:0,minWidth:"125px",maxWidth:"125px",borderRight:s?void 0:"#9EA3AC 2px solid"};return i&&a++,u.createElement(E.a,{style:o},u.createElement("span",{className:"header-2"},c.title),u.createElement("div",{style:{float:"right"}},u.createElement(Y.a,{icon:x.q,onClick:function(){}})),u.createElement(K.a,{value:n.state.filters[c.name],onChange:function(e){n.state.filters[c.name]=e,n.setState({filters:n.state.filters})}}))}))}},{key:"renderTableRow",value:function(e,t,n,a){var c=0,r=t%2===0?"#FFFFFF":"#F6F7FA";return u.createElement(C.a,{style:{backgroundColor:r},onClick:function(){"Inquiry"===e.type?window.location.href="#/customer-care/update-ticket/"+e.app_uid+"/"+e.app_number+"/"+e.ticket_no:"Outpatient Procedure"===e.specificType?window.location.href="#/customer-care/resolve-ticket/"+e.app_uid+"/"+e.app_number+"/"+e.ticket_no:"Inpatient"===e.specificType?window.location.href="#/customer-care/update-ticket/"+e.app_uid+"/"+e.app_number+"/"+e.ticket_no:"Consultation"===e.specificType&&(window.location.href="#/customer-care/resolve-ticket/"+e.app_uid+"/"+e.app_number+"/"+e.ticket_no)}},n.map(function(t,r){var i=a.filter(function(e){return e===t.name})[0],s=!0;i&&n[r+1]&&(s=!!a.filter(function(e){return e===n[r+1].name})[0]);var o={left:i?125*c:0,zIndex:i?125:0,position:i?"sticky":"relative",minWidth:"125px",maxWidth:"125px",borderRight:s?void 0:"#9EA3AC 2px solid"};i&&c++;return u.createElement(E.a,{style:o},0==r?u.createElement("div",{style:{width:"100%",textAlign:"center"}},u.createElement("div",{className:"number-item",style:{display:"inline-block",backgroundColor:{Low:"#3AB77D",Medium:"#FAB435",High:"#FD5451"}[e[t.name]]}},{Low:3,Medium:2,High:1}[e[t.name]])):3==r||10==r||11==r?V.a.toShortDateString(e[t.name]):13==r?e[t.name]?"Yes":"No":e[t.name])}))}}]),t}(u.Component),ee=function(e){return e.ticketList},te=function(e){return{Map:Object(m.b)(F,e)}}}}]);
//# sourceMappingURL=5.6d4330e9.chunk.js.map